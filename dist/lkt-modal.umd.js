(function(n,e){typeof exports=="object"&&typeof module<"u"?e(exports,require("vue"),require("lkt-modal-confirm"),require("lkt-loader")):typeof define=="function"&&define.amd?define(["exports","vue","lkt-modal-confirm","lkt-loader"],e):(n=typeof globalThis<"u"?globalThis:n||self,e(n.LktModal={},n.Vue,n.lktModalConfirm,n.LktLoader))})(this,function(n,e,i,_){"use strict";var H=Object.defineProperty;var W=(n,e,i)=>e in n?H(n,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):n[e]=i;var h=(n,e,i)=>(W(n,typeof e!="symbol"?e+"":e,i),i);const g=(o=>o&&typeof o=="object"&&"default"in o?o:{default:o})(_),y=(o,t="_")=>`${o}_${t}`;class B{constructor(){h(this,"config",[]);h(this,"components",{});h(this,"zIndex",500)}setConfig(t){this.config=t}addWindow(t){this.config.push(t)}findConfig(t){return this.config.find(l=>l.alias===t)}getModalInfo(t,l="_",a={}){const d=y(t,l);return{component:this.findConfig(t).component,alias:t,index:d,key:l,props:{...a,modalName:t,modalKey:l,zIndex:(()=>this.zIndex)()},zIndex:this.zIndex}}open(t,l="_",a={}){if(this.findConfig(t)){++this.zIndex;const c=this.getModalInfo(t,l,a);return this.components[c.index]?this.focus(c):(this.components[c.index]=c,this.components[c.index])}}focus(t){return this.components[t.index]=t,this.components[t.index]}close(t,l="_"){if(this.findConfig(t)){--this.zIndex;const d=this.getModalInfo(t,l,{});delete this.components[d.index],Object.keys(this.components).length===0&&(this.zIndex=500)}}}const r={controller:new B,canvas:void 0},b=(o,t="_",l={})=>{r.controller.open(o,t,l),r.canvas.refresh()},u=(o,t="_")=>{r.controller.close(o,t),r.canvas.refresh()},M=(o,t)=>{r.controller.addWindow({alias:o,component:t})},E=(o,t="_",l={})=>{r.controller.close(o,t),r.canvas.refresh(),e.nextTick(()=>{r.controller.open(o,t,l),r.canvas.refresh()})},x={class:"lkt-modal-canvas"},S=e.defineComponent({__name:"LktModalCanvas",setup(o,{expose:t}){const l=e.ref(0),{ctx:a}=e.getCurrentInstance(),d=()=>{l.value=l.value+1,setTimeout(()=>{a.$forceUpdate()},1)},c=e.computed(()=>(l.value,Object.values(r.controller.components)));return t({refresh:d}),(f,C)=>(e.openBlock(),e.createElementBlock("section",x,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(c.value,m=>(e.openBlock(),e.createBlock(e.resolveDynamicComponent(m.component),e.mergeProps({key:m.index},m.props),null,16))),128))]))}}),z={class:"lkt-modal-inner",ref:"inner"},N={class:"lkt-modal-header"},I={class:"lkt-modal-header_title-container"},V={key:0,class:"lkt-modal-header_pre-title"},L=["innerHTML"],$={key:2,class:"lkt-modal-header_title"},T={class:"lkt-modal-button-tray"},w=["disabled"],O={class:"lkt-modal-content"},j={key:0,class:"lkt-modal-footer"},K={key:0,class:"lkt-modal-footer_main"},D={key:1,class:"lkt-modal-button-tray"},F=e.defineComponent({__name:"LktModal",props:{palette:{type:String,default:""},size:{type:String,default:""},preTitle:{type:String,default:""},title:{type:String,default:""},closeConfirm:{type:String,default:""},closeConfirmKey:{type:String,default:"_"},showClose:{type:Boolean,default:!0},disabledClose:{type:Boolean,default:!1},disabledVeilClick:{type:Boolean,default:!1},modalName:{type:String,default:""},modalKey:{type:[String,Number],default:"_"},zIndex:{type:Number,default:500},beforeClose:{type:Function,default:void 0}},setup(o){const t=o,l=e.ref(0),a=e.computed(()=>{let s=["lkt-modal"];return t.size&&s.push(`is-${t.size}`),t.palette&&s.push(`is-${t.palette}`),s.join(" ")}),d=()=>{const s=async()=>{typeof t.beforeClose=="function"&&await t.beforeClose(),u(t.modalName,t.modalKey)};if(t.closeConfirm){i.openConfirm(t.closeConfirm,t.closeConfirmKey,{onConfirm:s});return}s()},c=()=>{t.disabledVeilClick||d()},f=e.useSlots(),C=e.computed(()=>{l.value;let s=[];for(let k in f)k.indexOf("button-")===0&&s.push(k);return s}),m=e.computed(()=>{l.value;let s=[];for(let k in f)k.indexOf("footer-button-")===0&&s.push(k);return s});return(s,k)=>(e.openBlock(),e.createElementBlock("section",{class:e.normalizeClass(a.value),style:e.normalizeStyle("z-index: "+o.zIndex)},[e.createElementVNode("div",{class:"lkt-modal-back",onClick:e.withModifiers(c,["prevent","stop"])}),e.createElementVNode("div",z,[e.createElementVNode("header",N,[e.createElementVNode("div",I,[e.unref(f)["pre-title"]?(e.openBlock(),e.createElementBlock("div",V,[e.renderSlot(s.$slots,"pre-title")])):o.preTitle?(e.openBlock(),e.createElementBlock("div",{key:1,class:"lkt-modal-header_pre-title",innerHTML:o.preTitle},null,8,L)):e.createCommentVNode("",!0),o.title?(e.openBlock(),e.createElementBlock("div",$,e.toDisplayString(o.title),1)):e.createCommentVNode("",!0)]),e.createElementVNode("div",T,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(C.value,p=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass("lkt-modal-button lkt-modal-"+p)},[e.renderSlot(s.$slots,p)],2))),256)),o.showClose?(e.openBlock(),e.createElementBlock("button",{key:0,class:"lkt-modal-button lkt-modal-button-close",onClick:e.withModifiers(d,["prevent","stop"]),disabled:o.disabledClose},null,8,w)):e.createCommentVNode("",!0)])]),e.createElementVNode("section",O,[e.renderSlot(s.$slots,"default")]),m.value.length>0||!!e.unref(f).footer?(e.openBlock(),e.createElementBlock("footer",j,[e.unref(f).footer?(e.openBlock(),e.createElementBlock("div",K,[e.renderSlot(s.$slots,"footer")])):e.createCommentVNode("",!0),m.value.length>0?(e.openBlock(),e.createElementBlock("div",D,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(m.value,p=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass("lkt-modal-button lkt-modal-"+p)},[e.renderSlot(s.$slots,p)],2))),256))])):e.createCommentVNode("",!0)])):e.createCommentVNode("",!0)],512)],6))}}),A="",q={install:o=>{o.component("lkt-modal-canvas")===void 0&&o.component("lkt-modal-canvas",S),o.component("lkt-modal")===void 0&&o.component("lkt-modal",F),o.component("lkt-loader")===void 0&&o.use(g.default)}},P=o=>{r.canvas=o};n.addModal=M,n.closeModal=u,n.default=q,n.openModal=b,n.reOpenModal=E,n.setCanvas=P,Object.defineProperties(n,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
